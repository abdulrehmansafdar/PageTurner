<div class="min-h-screen bg-gradient-to-br from-slate-50 to-slate-100">
  <div class="container mx-auto px-4 py-8 max-w-7xl">
    <!-- Header -->
    <div class="flex items-center justify-between mb-8">
      <div>
        <h1 class="text-4xl font-bold text-slate-900 mb-2">Complete Your Purchase</h1>
        <p class="text-slate-600">Secure checkout powered by industry-leading encryption</p>
      </div>
      <div class="flex items-center gap-2 px-4 py-2 bg-emerald-50 rounded-full border border-emerald-200">
        <svg class="h-5 w-5 text-emerald-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"></path>
        </svg>
        <span class="text-sm font-medium text-emerald-700">Secure Checkout</span>
      </div>
    </div>

    <!-- Progress Bar -->
    <div class="mb-12">
      <div class="relative">
        <div class="h-3 bg-slate-200 rounded-full overflow-hidden">
          <div class="h-full bg-gradient-to-r from-[#fe7743] to-[#ff8f65] rounded-full w-2/3 transition-all duration-500"></div>
        </div>
        <div class="flex justify-between absolute -top-3 w-full">
          <div class="bg-[#fe7743] rounded-full h-9 w-9 flex items-center justify-center text-white text-sm font-bold shadow-lg">
            <svg class="h-5 w-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
            </svg>
          </div>
          <div class="bg-[#fe7743] rounded-full h-9 w-9 flex items-center justify-center text-white text-sm font-bold shadow-lg">
            2
          </div>
          <div class="bg-slate-300 rounded-full h-9 w-9 flex items-center justify-center text-slate-500 text-sm font-bold">
            3
          </div>
        </div>
        <div class="flex justify-between absolute -bottom-8 w-full text-sm">
          <div class="text-center font-medium text-slate-600">
            <div class="text-[#fe7743]">âœ“ Cart</div>
          </div>
          <div class="text-center font-medium">
            <div class="text-[#fe7743] font-semibold">Checkout</div>
          </div>
          <div class="text-center font-medium text-slate-500">
            <div>Confirmation</div>
          </div>
        </div>
      </div>
    </div>

    <div class="grid grid-cols-1 lg:grid-cols-3 gap-8 mt-16">
      <!-- Order Summary -->
      <div class="lg:col-span-1 order-1 lg:order-2">
        <div class="sticky top-4 border-0 shadow-xl bg-white/80 backdrop-blur-sm rounded-xl p-6">
          <div class="pb-4">
            <h2 class="flex items-center gap-3 text-xl text-slate-900 font-bold">
              <div class="p-2 bg-[#fe7743] rounded-lg">
                <svg class="h-5 w-5 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 3h2l.4 2M7 13h10l4-8H5.4m0 0L7 13m0 0l-1.5 5M7 13l-1.5 5m0 0h9m-9 0a1 1 0 100 2 1 1 0 000-2zm9 0a1 1 0 100 2 1 1 0 000-2z"></path>
                </svg>
              </div>
              Order Summary
            </h2>
          </div>
          
          <div class="space-y-6">
            <!-- Cart Items -->
            <div class="space-y-4 max-h-64 overflow-y-auto pr-2 custom-scrollbar">
              <div *ngFor="let item of cartItems" class="flex items-center gap-4 p-3 bg-slate-50 rounded-xl border border-slate-100">
                <img [src]="item.book.imageUrl" [alt]="item.book.title" class="w-14 h-18 object-cover rounded-lg shadow-sm">
                <div class="flex-1 min-w-0">
                  <h4 class="font-semibold text-sm text-slate-900 truncate">{{ item.book.title }}</h4>
                  <p class="text-xs text-slate-600 mb-2">by {{ item.book.author }}</p>
                  <div class="flex justify-between items-center">
                    <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-slate-100 text-slate-800">
                      Qty: {{ item.quantity }}
                    </span>
                    <span class="font-bold text-sm text-slate-900">
                      ${{ (item.book.price * item.quantity).toFixed(2) }}
                    </span>
                  </div>
                </div>
              </div>
            </div>

            <!-- Promo Code -->
            <div class="p-4 bg-gradient-to-r from-slate-50 to-slate-100 rounded-xl border border-slate-200">
              <div class="flex gap-2">
                <input type="text" placeholder="Enter promo code" 
                       class="flex-1 border border-slate-300 rounded-lg px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-[#fe7743] focus:border-[#fe7743] transition-all duration-200">
                <button class="border border-[#fe7743] text-[#fe7743] hover:bg-[#fe7743] hover:text-white transition-all duration-200 px-4 py-2 rounded-lg text-sm font-medium">
                  Apply
                </button>
              </div>
            </div>

            <div class="border-t border-slate-200"></div>

            <!-- Totals -->
            <div class="space-y-3">
              <div class="flex justify-between text-sm">
                <span class="text-slate-600">Subtotal</span>
                <span class="font-medium text-slate-900">${{ cartSubtotal.toFixed(2) }}</span>
              </div>
              <div class="flex justify-between text-sm">
                <span class="text-slate-600">Shipping</span>
                <span class="font-medium text-emerald-600">Free</span>
              </div>
              <div class="flex justify-between text-sm">
                <span class="text-slate-600">Tax (8%)</span>
                <span class="font-medium text-slate-900">${{ (cartSubtotal * 0.08).toFixed(2) }}</span>
              </div>
              <div class="border-t border-slate-200"></div>
              <div class="flex justify-between items-center pt-2">
                <span class="text-lg font-bold text-slate-900">Total</span>
                <span class="text-2xl font-bold text-[#fe7743]">${{ cartTotal.toFixed(2) }}</span>
              </div>
            </div>

            <!-- Security Notice -->
            <div class="p-4 bg-emerald-50 rounded-xl border border-emerald-200">
              <div class="flex items-center gap-2 text-sm text-emerald-700">
                <svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"></path>
                </svg>
                <span class="font-medium">Your payment information is secure and encrypted</span>
              </div>
            </div>

            <!-- Delivery Info -->
            <div class="p-4 bg-gradient-to-r from-[#fe7743]/10 to-[#ff8f65]/10 rounded-xl border border-[#fe7743]/20">
              <div class="flex items-start gap-3">
                <div class="p-2 bg-[#fe7743] rounded-lg">
                  <svg class="h-4 w-4 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4"></path>
                  </svg>
                </div>
                <div>
                  <h4 class="font-semibold text-sm text-slate-900 mb-1">Estimated Delivery</h4>
                  <p class="text-sm text-slate-700">
                    {{ getDeliveryDate() | date:'MMMM d' }} - {{ getDeliveryDate(5) | date:'MMMM d' }}
                  </p>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Forms -->
      <div class="lg:col-span-2 order-2 lg:order-1 space-y-6">
        <!-- Shipping Information -->
        <div class="border-0 shadow-xl bg-white/80 backdrop-blur-sm rounded-xl p-6">
          <div class="pb-6">
            <h2 class="flex items-center gap-3 text-xl text-slate-900 font-bold">
              <div class="p-2 bg-slate-700 rounded-lg">
                <svg class="h-5 w-5 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"></path>
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"></path>
                </svg>
              </div>
              Shipping Information
            </h2>
          </div>
          
          <form [formGroup]="checkoutForm" class="space-y-6">
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
              <div class="space-y-2">
                <label for="firstName" class="block text-sm font-semibold text-slate-700">First Name</label>
                <input type="text" id="firstName" formControlName="firstName"
                       class="w-full border border-slate-300 rounded-lg px-4 py-3 focus:outline-none focus:ring-2 focus:ring-[#fe7743] focus:border-[#fe7743] transition-all duration-200 h-12"
                       placeholder="Enter your first name"
                       [class.border-red-500]="checkoutForm.get('firstName')?.invalid && checkoutForm.get('firstName')?.touched">
                <div *ngIf="checkoutForm.get('firstName')?.invalid && checkoutForm.get('firstName')?.touched"
                     class="text-red-500 text-sm mt-1">
                  First name is required
                </div>
              </div>
              
              <div class="space-y-2">
                <label for="lastName" class="block text-sm font-semibold text-slate-700">Last Name</label>
                <input type="text" id="lastName" formControlName="lastName"
                       class="w-full border border-slate-300 rounded-lg px-4 py-3 focus:outline-none focus:ring-2 focus:ring-[#fe7743] focus:border-[#fe7743] transition-all duration-200 h-12"
                       placeholder="Enter your last name"
                       [class.border-red-500]="checkoutForm.get('lastName')?.invalid && checkoutForm.get('lastName')?.touched">
                <div *ngIf="checkoutForm.get('lastName')?.invalid && checkoutForm.get('lastName')?.touched"
                     class="text-red-500 text-sm mt-1">
                  Last name is required
                </div>
              </div>
            </div>

            <!-- Phone Number with Country Code -->
            <div class="space-y-2">
              <label for="phone" class="block text-sm font-semibold text-slate-700">Phone Number</label>
              <div class="flex gap-2">
                <select [(ngModel)]="selectedCountryCode" [ngModelOptions]="{standalone: true}"
                        class="w-32 border border-slate-300 rounded-lg px-3 py-3 focus:outline-none focus:ring-2 focus:ring-[#fe7743] focus:border-[#fe7743] transition-all duration-200 h-12 bg-white">
                  <option *ngFor="let country of countryCodes" [value]="country.code">
                    {{ country.flag }} {{ country.code }}
                  </option>
                </select>
                <input type="tel" id="phone" formControlName="phone" placeholder="1234567890"
                       class="flex-1 border border-slate-300 rounded-lg px-4 py-3 focus:outline-none focus:ring-2 focus:ring-[#fe7743] focus:border-[#fe7743] transition-all duration-200 h-12"
                       [class.border-red-500]="checkoutForm.get('phone')?.invalid && checkoutForm.get('phone')?.touched">
              </div>
              <div *ngIf="checkoutForm.get('phone')?.invalid && checkoutForm.get('phone')?.touched"
                   class="text-red-500 text-sm mt-1">
                Valid phone number is required (10 digits)
              </div>
            </div>

            <div class="space-y-2">
              <label for="address" class="block text-sm font-semibold text-slate-700">Street Address</label>
              <input type="text" id="address" formControlName="address"
                     class="w-full border border-slate-300 rounded-lg px-4 py-3 focus:outline-none focus:ring-2 focus:ring-[#fe7743] focus:border-[#fe7743] transition-all duration-200 h-12"
                     placeholder="Enter your street address"
                     [class.border-red-500]="checkoutForm.get('address')?.invalid && checkoutForm.get('address')?.touched">
              <div *ngIf="checkoutForm.get('address')?.invalid && checkoutForm.get('address')?.touched"
                   class="text-red-500 text-sm mt-1">
                Address is required
              </div>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
              <div class="space-y-2">
                <label for="country" class="block text-sm font-semibold text-slate-700">Country</label>
                <select id="country" formControlName="country"
                        class="w-full border border-slate-300 rounded-lg px-4 py-3 focus:outline-none focus:ring-2 focus:ring-[#fe7743] focus:border-[#fe7743] transition-all duration-200 h-12 bg-white"
                        [class.border-red-500]="checkoutForm.get('country')?.invalid && checkoutForm.get('country')?.touched">
                  <option value="">Select Country</option>
                  <option value="US">ðŸ‡ºðŸ‡¸ United States</option>
                  <option value="CA">ðŸ‡¨ðŸ‡¦ Canada</option>
                  <option value="UK">ðŸ‡¬ðŸ‡§ United Kingdom</option>
                  <option value="AU">ðŸ‡¦ðŸ‡º Australia</option>
                  <option value="DE">ðŸ‡©ðŸ‡ª Germany</option>
                  <option value="FR">ðŸ‡«ðŸ‡· France</option>
                  <option value="JP">ðŸ‡¯ðŸ‡µ Japan</option>
                  <option value="IN">ðŸ‡®ðŸ‡³ India</option>
                </select>
                <div *ngIf="checkoutForm.get('country')?.invalid && checkoutForm.get('country')?.touched"
                     class="text-red-500 text-sm mt-1">
                  Country is required
                </div>
              </div>
              
            
              
              <div class="space-y-2">
                <label for="city" class="block text-sm font-semibold text-slate-700">City</label>
                <input type="text" id="city" formControlName="city"
                       class="w-full border border-slate-300 rounded-lg px-4 py-3 focus:outline-none focus:ring-2 focus:ring-[#fe7743] focus:border-[#fe7743] transition-all duration-200 h-12"
                       placeholder="City"
                       [class.border-red-500]="checkoutForm.get('city')?.invalid && checkoutForm.get('city')?.touched">
                <div *ngIf="checkoutForm.get('city')?.invalid && checkoutForm.get('city')?.touched"
                     class="text-red-500 text-sm mt-1">
                  City is required
                </div>
              </div>
              
              <div class="space-y-2">
                <label for="zipCode" class="block text-sm font-semibold text-slate-700">ZIP Code</label>
                <input type="text" id="zipCode" formControlName="zipCode"
                       class="w-full border border-slate-300 rounded-lg px-4 py-3 focus:outline-none focus:ring-2 focus:ring-[#fe7743] focus:border-[#fe7743] transition-all duration-200 h-12"
                       placeholder="12345"
                       [class.border-red-500]="checkoutForm.get('zipCode')?.invalid && checkoutForm.get('zipCode')?.touched">
                <div *ngIf="checkoutForm.get('zipCode')?.invalid && checkoutForm.get('zipCode')?.touched"
                     class="text-red-500 text-sm mt-1">
                  Valid ZIP code is required (5 digits)
                </div>
              </div>
            </div>
          </form>
        </div>

        <!-- Payment Information -->
        <div class="border-0 shadow-xl bg-white/80 backdrop-blur-sm rounded-xl p-6">
          <div class="pb-6">
            <h2 class="flex items-center gap-3 text-xl text-slate-900 font-bold">
              <div class="p-2 bg-slate-700 rounded-lg">
                <svg class="h-5 w-5 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"></path>
                </svg>
              </div>
              Payment Method
            </h2>
          </div>
          
          <div class="space-y-6">
            <!-- Payment Method Selection -->
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
              <div [class]="'border-2 rounded-xl p-4 cursor-pointer transition-all duration-200 ' + 
                          (selectedPayment === 'credit' ? 'border-[#fe7743] bg-[#fe7743]/5 shadow-lg' : 'border-slate-200 hover:border-[#fe7743]/50 hover:shadow-md')"
                   (click)="setPaymentMethod('credit')">
                <div class="flex items-center gap-3">
                  <div [class]="'w-6 h-6 rounded-full border-2 flex items-center justify-center ' + 
                              (selectedPayment === 'credit' ? 'border-[#fe7743]' : 'border-slate-300')">
                    <div *ngIf="selectedPayment === 'credit'" class="w-3 h-3 rounded-full bg-[#fe7743]"></div>
                  </div>
                  <div>
                    <span class="font-semibold text-slate-900">Credit Card</span>
                    <div class="flex gap-1 mt-2">
                      <div class="w-8 h-5 bg-blue-600 rounded"></div>
                      <div class="w-8 h-5 bg-red-500 rounded"></div>
                      <div class="w-8 h-5 bg-slate-800 rounded"></div>
                    </div>
                  </div>
                </div>
                <p class="text-xs text-slate-600 mt-3 ml-9">Pay securely with your credit or debit card</p>
              </div>

              <div [class]="'border-2 rounded-xl p-4 cursor-pointer transition-all duration-200 ' + 
                          (selectedPayment === 'cod' ? 'border-[#fe7743] bg-[#fe7743]/5 shadow-lg' : 'border-slate-200 hover:border-[#fe7743]/50 hover:shadow-md')"
                   (click)="setPaymentMethod('cod')">
                <div class="flex items-center gap-3">
                  <div [class]="'w-6 h-6 rounded-full border-2 flex items-center justify-center ' + 
                              (selectedPayment === 'cod' ? 'border-[#fe7743]' : 'border-slate-300')">
                    <div *ngIf="selectedPayment === 'cod'" class="w-3 h-3 rounded-full bg-[#fe7743]"></div>
                  </div>
                  <span class="font-semibold text-slate-900">Cash on Delivery</span>
                </div>
                <p class="text-xs text-slate-600 mt-3 ml-9">Pay when your order is delivered</p>
              </div>
            </div>

            <!-- Payment Details -->
            <form [formGroup]="paymentForm" *ngIf="selectedPayment === 'credit'" class="space-y-4 p-4 bg-slate-50 rounded-xl border border-slate-200">
              <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                <div class="space-y-2">
                  <label for="cardNumber" class="block text-sm font-semibold text-slate-700">Card Number</label>
                  <input type="text" id="cardNumber" formControlName="cardNumber" placeholder="1234 5678 9012 3456"
                         class="w-full border border-slate-300 rounded-lg px-4 py-3 focus:outline-none focus:ring-2 focus:ring-[#fe7743] focus:border-[#fe7743] transition-all duration-200 h-12"
                         [class.border-red-500]="paymentForm.get('cardNumber')?.invalid && paymentForm.get('cardNumber')?.touched">
                  <div *ngIf="paymentForm.get('cardNumber')?.invalid && paymentForm.get('cardNumber')?.touched"
                       class="text-red-500 text-sm mt-1">
                    Valid card number is required (16 digits)
                  </div>
                </div>
                
                <div class="space-y-2">
                  <label for="cardExpiry" class="block text-sm font-semibold text-slate-700">Expiry Date</label>
                  <input type="text" id="cardExpiry" formControlName="cardExpiry" placeholder="MM/YY"
                         class="w-full border border-slate-300 rounded-lg px-4 py-3 focus:outline-none focus:ring-2 focus:ring-[#fe7743] focus:border-[#fe7743] transition-all duration-200 h-12"
                         [class.border-red-500]="paymentForm.get('cardExpiry')?.invalid && paymentForm.get('cardExpiry')?.touched">
                  <div *ngIf="paymentForm.get('cardExpiry')?.invalid && paymentForm.get('cardExpiry')?.touched"
                       class="text-red-500 text-sm mt-1">
                    Valid expiry date required (MM/YY)
                  </div>
                </div>
                
                <div class="space-y-2">
                  <label for="cardCvv" class="block text-sm font-semibold text-slate-700">CVV</label>
                  <input type="text" id="cardCvv" formControlName="cardCvv" placeholder="123"
                         class="w-full border border-slate-300 rounded-lg px-4 py-3 focus:outline-none focus:ring-2 focus:ring-[#fe7743] focus:border-[#fe7743] transition-all duration-200 h-12"
                         [class.border-red-500]="paymentForm.get('cardCvv')?.invalid && paymentForm.get('cardCvv')?.touched">
                  <div *ngIf="paymentForm.get('cardCvv')?.invalid && paymentForm.get('cardCvv')?.touched"
                       class="text-red-500 text-sm mt-1">
                    Valid CVV required (3-4 digits)
                  </div>
                </div>
              </div>
            </form>

            <div *ngIf="selectedPayment === 'cod'" class="p-4 bg-amber-50 rounded-xl border border-amber-200">
              <div class="flex items-start gap-3">
                <svg class="h-5 w-5 text-amber-600 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                </svg>
                <div class="space-y-2">
                  <p class="text-sm text-amber-800 font-medium">
                    You'll pay the full amount when your order is delivered.
                  </p>
                  <p class="text-sm text-amber-700">
                    Please ensure you have the exact amount ready. Additional delivery fee may apply.
                  </p>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Submit Section -->
        <div class="border-0 shadow-xl bg-white/80 backdrop-blur-sm rounded-xl p-6">
          <div class="flex flex-col md:flex-row md:items-center md:justify-between gap-4">
            <div class="space-y-2">
              <div class="flex items-center gap-2">
                <input type="checkbox" class="h-4 w-4 text-[#fe7743] rounded border-slate-300 focus:ring-[#fe7743]">
                <span class="text-sm text-slate-700">Email me about special offers and new releases</span>
              </div>
              <p class="text-xs text-slate-500">
                By completing this purchase, you agree to our 
                <a href="#" class="text-[#fe7743] hover:underline font-medium">Terms of Service</a>.
              </p>
            </div>

            <button type="submit" (click)="onSubmit()" [disabled]="checkoutForm.invalid || isSubmitting"
                    class="bg-gradient-to-r from-[#fe7743] to-[#ff8f65] hover:from-[#fd6a2f] hover:to-[#fe7743] text-white py-6 px-8 rounded-xl font-semibold text-lg transition-all duration-200 shadow-lg hover:shadow-xl disabled:opacity-50 disabled:cursor-not-allowed min-w-[200px] flex items-center justify-center gap-2">
              <svg *ngIf="!isSubmitting" class="h-5 w-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"></path>
              </svg>
              <span *ngIf="!isSubmitting">Complete Order</span>
              
              <div *ngIf="isSubmitting" class="flex items-center gap-2">
                <svg class="animate-spin h-5 w-5 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                  <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                  <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                </svg>
                Processing...
              </div>
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
